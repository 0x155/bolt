{# Check which field types are used #}

{% set used_fieldtypes = [] %}

{# Regular fields #}
{% for key, field in context.contenttype.fields %}
    {% if field.type not in used_fieldtypes %}
        {% set used_fieldtypes = used_fieldtypes|merge([field.type]) %}
    {% endif %}
{% endfor %}

{# Templatefield fields #}
{% if context.content.get('templatefields').contenttype.fields is defined %}
    {% for key, field in context.content.get('templatefields').contenttype.fields %}
        {% if field.type not in used_fieldtypes %}
            {% set used_fieldtypes = used_fieldtypes|merge([field.type]) %}
        {% endif %}
    {% endfor %}
{% endif %}

{# Output includes #}

{% if 'html' in used_fieldtypes %}
    <script src="{{ paths.app }}view/js/ckeditor/ckeditor.js"></script>
{% endif %}

{% if 'markdown' in used_fieldtypes %}
    <script src="{{ paths.app }}view/js/uikit/uikit.min.js"></script>
    <script src="{{ paths.app }}view/js/uikit/marked.js"></script>
    <script src="{{ paths.app }}view/js/uikit/codemirror-compressed.js"></script>
    <script src="{{ paths.app }}view/js/uikit/htmleditor.js"></script>
    <link rel="stylesheet" property="stylesheet" href="{{ paths.app }}view/js/ckeditor/plugins/codemirror/css/codemirror.min.css">
    <link rel="stylesheet" property="stylesheet" href="{{ paths.app }}view/js/uikit/htmleditor.min.css">
{% endif %}

{% if 'geolocation' in used_fieldtypes %}
    {{ data('field.geolocation.title-pin', __('field.geolocation.title-pin')) }}
    <script src="https://maps.google.com/maps/api/js?sensor=false"></script>
{% endif %}

{% if 'slug' in used_fieldtypes %}
    {{ data('field.slug.message.set', __('field.slug.message.set')) }}
    {{ data('field.slug.message.unlock', __('field.slug.message.unlock')) }}
{% endif %}

{% if 'templateselect' in used_fieldtypes %}
    {{ data('field.templateselect.message.change', __('This template adds new fields. Save, then refresh to see these changes.')) }}
    {{ data('field.templateselect.message.warning', __('You may lose some of your template fields with this change. Go to the template section and note down the values before doing this.')) }}
    {{ data('field.templateselect.message.status', __('Warning')) }}
    {{ data('field.templateselect.template.warning', '<strong>%STATUS%:</strong> %MESSAGE%') }}
{% endif %}

{% if 'filelist' in used_fieldtypes %}
    {% set filelist_empty %}
        <p>{{ __('No files in the list, yet.') }}</p>
    {% endset %}
    {{ data('field.filelist.template.empty', filelist_empty|trim) }}

    {% set filelist_item %}
        <div data-id="%ID%" class="list-item ui-state-default">
            <input type="text" value="%VAL%">
            <a href="#" class="remove-button"><i class="fa fa-times"></i></a>
            <span>%FNAME%</span>
        </div>
    {% endset %}
    {{ data('field.filelist.template.item', filelist_item|trim|preg_replace('/>\\s+</', '><')) }}

    {% set filelist_progress %}
        <div class="uploading-list-element">
            {{ __('Uploading') }} %FNAME%
            <div class="progress files-progress progress-striped active">
                <div class="progress-bar"></div>
            </div>
        </div>
    {% endset %}
    {{ data('field.filelist.template.progress', filelist_progress|trim|preg_replace('/>\\s+</', '><')) }}

    {{ data('field.filelist.message.remove', __('Are you sure you want to remove this file?')) }}
    {{ data('field.filelist.message.removeMulti', __('Are you sure you want to remove these files?')) }}
    {{ data('field.filelist.message.wrongtype', __('There was an error uploading the file.\nMake sure that the file type is of:\n%TYPELIST%')) }}
{% endif %}

{% if 'imagelist' in used_fieldtypes %}
    {% set imagelist_empty %}
        <p>{{ __('No images in the list, yet.') }}</p>
    {% endset %}
    {{ data('field.imagelist.template.empty', imagelist_empty|trim) }}

    {% set imagelist_item %}
        <div data-id="%ID%" class="list-item ui-state-default">
            <a class="thumbnail-link" href="%PATH%../files/%FNAME%">
                <img src="%PATH%../thumbs/60x40/%FNAME%" width="60" height="40">
            </a>
            <input type="text" value="%VAL%">
            <a href="#" class="remove-button"><i class="fa fa-times"></i></a>
        </div>
    {% endset %}
    {{ data('field.imagelist.template.item', imagelist_item|trim|preg_replace('/>\\s+</', '><')) }}

    {% set imagelist_progress %}
        <div class="uploading-list-element">
            {{ __('Uploading') }} %FNAME%
            <div class="progress files-progress progress-striped active">
                <div class="progress-bar"></div>
            </div>
        </div>
    {% endset %}
    {{ data('field.imagelist.template.progress', imagelist_progress|trim|preg_replace('/>\\s+</', '><')) }}

    {{ data('field.imagelist.message.remove', __('Are you sure you want to remove this image?')) }}
    {{ data('field.imagelist.message.removeMulti', __('Are you sure you want to remove these images?')) }}
    {{ data('field.imagelist.message.wrongtype', __('There was an error uploading the file.\nMake sure that the file type is of:\n%TYPELIST%')) }}
{% endif %}
