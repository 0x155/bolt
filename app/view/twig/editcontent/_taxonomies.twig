{# taxonomies for the contenttype that this record is part of. #}

{% if not context.has.tabs %}
    <h3>
        {{ __('Taxonomy') }}
        <span class="label info-pop" data-html="true" data-title="{{ __('Taxonomy') }}"
                  data-content="{{ app.translator.trans('info.taxonomy',{},'infos') }}">{{ __('Info') }}</span>
    </h3>
{% endif %}

{% for taxonomyslug in context.contenttype.taxonomy|default([]) %}
    {% if config.get('taxonomy')[taxonomyslug] is defined %}
        {% set taxonomy = config.get('taxonomy')[taxonomyslug] %}

        <div data-fieldtype="taxonomy-{{ taxonomy.behaves_like }}">

            {# --------------- prefix --------------- #}
            {% if taxonomy.prefix is defined and taxonomy.prefix is not empty %}
                <div class="prefix">
                    {{ taxonomy.prefix|markdown }}
                </div>
            {% endif %}

            {# ---------- tags ---------- #}

            {% if taxonomy.behaves_like == "tags" %}
                {% include 'editcontent/fields/_taxonomy-tags.twig' %}
            {% endif %}

            {# ---------- categories ---------- #}

            {% if taxonomy.behaves_like == "categories" %}
                {% include 'editcontent/fields/_taxonomy-categories.twig' %}
            {% endif %}

            {# ---------- grouping ---------- #}

            {% if taxonomy.behaves_like == "grouping" %}

                <fieldset class="form-group" data-bolt-field="taxonomy-grouping">

                    {{ macro.label(taxonomy.name, '', 'col-sm-3 control-label', 'taxonomy-' ~ taxonomy.slug) }}

                    <div class="col-sm-9">

                    <select name="taxonomy[{{ taxonomy.slug }}][]" id="taxonomy-{{ taxonomy.slug }}" class="narrow form-control pull-left">
                        <option value="">{{ __('(no group)') }}</option>
                        <option value="" disabled>-----------</option>
                    {% for slug, group in taxonomy.options %}
                        <option value="{{ slug }}" {% if context.content.taxonomy[taxonomy.slug] is defined and group in context.content.taxonomy[taxonomy.slug] or context.content.taxonomy[taxonomy.slug] is not defined and taxonomy.default is defined and taxonomy.default == slug %}selected{% endif %}>{{ group }}</option>
                    {% endfor %}
                    </select>

                    {% if taxonomy.has_sortorder is defined and taxonomy.has_sortorder == true %}
                        <label for="taxonomy-order-{{ taxonomy.slug }}" class=" pull-left" style="margin: 6px 8px 0;">- Order:</label>
                        {% if context.content.sortorder %}
                            {% set sortorder = context.content.sortorder %}
                        {% else %}
                            {% set sortorder = 0 %}
                        {% endif %}
                        <input type="number" name="taxonomy-order[{{ taxonomy.slug }}]" id="taxonomy-order-{{ taxonomy.slug }}" step="1"
                               value="{{ sortorder }}" class="verynarrow form-control pull-left">
                    {% endif %}

                </fieldset>
            {% endif %}

            {# --------------- postfix --------------- #}
            {% if taxonomy.postfix is defined and taxonomy.postfix is not empty %}
                <div class="postfix">
                    {{ taxonomy.postfix|markdown }}
                </div>
            {% endif %}
        </div>
    {% endif %}
{% endfor %}

{% if context.has.tabs and 'taxonomy' in context.contenttype.groups %}
    {% include 'editcontent/_fields.twig' %}
{% endif %}

{% if not context.has.tabs %}
    <hr>
{% endif %}
