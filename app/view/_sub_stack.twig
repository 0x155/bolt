{% if stack %}
    <section>
        <h2><i class="icon-paper-clip"></i> {{ __('Files on the stack') }}</h2>

        <div id="protostack">

            <div class="stackitem image info-pop item-1" data-placement="bottom" data-html="true" data-title="" data-content="">
                <img src="" width="100" height="100">
            </div>

            <div class="stackitem other info-pop item-1" data-placement="bottom" data-html="true" data-title="" data-content="">
                <strong>HTML</strong>
                <small>index.html</small>
            </div>

        </div>

        <div id="stackholder">
            {% for item in stack %}

            <div class="stackitem item-{{ loop.index }} {{ item.type }} info-pop"
                 data-placement="bottom" data-html="true" data-title="{{ item.basename }}" data-content="{{ item.info }}">
                {% if item.type == "image" %}
                    <img src="{{ item.filepath|thumbnail(100,100) }}" width="100" height="100">
                {% else %}
                   <strong>{{ item.extension|upper }}</strong>
                   <small>{{ item.basename }}</small>
                {% endif %}
            </div>

            {% endfor %}
        </div>

        <div class="btn-group">
            <span class="btn btn-info fileinput-button">
                <i class="icon-upload"></i>
                <span>{{ __('Upload image') }}</span>
                <input id="fileupload-stack" type="file" name="fileupload-stack[]" data-url="{{ paths.app }}classes/upload/">
            </span>
        </div>

        <div class="btn-group" style="margin-left: 0px;">
            <a data-target="#selectImageModal-stack" href="{{ paths.async }}browse/files" class="btn fileinput-select" data-toggle="modal">
                <i class="icon-upload-alt"></i>
                {{ __('Select from server') }}
            </a>
        </div>

        <!-- Modal "select from server"  -->
        <div class="modal hide modal-wide" id="selectImageModal-stack" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

            <div class="modal-body">
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{ __('Cancel') }}</button>
            </div>
        </div>

    </section>



{% if not ismobileclient() %}

    <script type="text/javascript">
        $(function() {
            bindFileUpload('stack');

            // In the modal dialog, to navigate folders..
            $('#selectImageModal-stack').on('click','.folder', function(e) {
                e.preventDefault();
                $('#selectImageModal-stack .modal-body').load($(this).attr('href'));
            });

            // In the modal dialog, to select a file..
            $('#selectImageModal-stack').on('click','.file', function(e) {
                e.preventDefault();
                addToStack($(this).attr('href'));
                $('#selectImageModal-stack').modal('hide');
            });


        });
    </script>
{% endif %}


{% endif %}
